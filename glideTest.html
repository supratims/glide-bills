<html>
<head>
	<meta charset="utf-8">
	<title>Glide test interface</title>
	<link rel="stylesheet" href="components/bootstrap/css/bootstrap.min.css">
	<script type="text/javascript" src="components/jquery/jquery.min.js"></script>
	<script type="text/javascript">
	$(document).ready(function() {
		$('body').on("click", 'a.submitFormButton', function(e) {
			e.preventDefault();
			$('form').each(function() {
				var formId=$(this).data('formid');
				$('#result'+formId).html('Loading ...');
				$.ajax({
					url: 'uitestGlide.php',
					type: 'POST',
					async: 'true',
					data: $('#'+formId).serialize(),
					success: function(d) {
						var res = $.parseJSON(d);
						if (res.error == 'exception') {
							delete res.error;
							$('#result'+formId).removeClass('alert-success').addClass('alert-danger');
						} else {
							$('#result'+formId).removeClass('alert-danger').addClass('alert-success');
						}		
						str = '';
						//console.log(res);
						walk(res);
						$('#result'+formId).html(str);		
					}
				});
			});
		});
		$.ajax({
			url: 'uitestGlide.php',
			type: 'GET',
			data: {},
			success: function(res) {				
				$('#main').append('<div class="col-xs-12"><a title="Click to test" class="pull-right btn btn-primary submitFormButton">Test</a></div>');
				$('#main').append(res);
			}
		});

	});
	var str = '';
	function walk(obj) {
		//console.log(typeof obj);
		if (obj instanceof Object) {
			for (var key in obj) {
				if (obj.hasOwnProperty(key)) {
				    var val = obj[key];
				    if (typeof val == 'string' || typeof val == 'number')
				    	str += key + ": " + val + "<br>";
				    else {
				    	str += '<br>'+ key + ": ";
				    	walk(val);	
				    }									
				}
			}			
		}	
	}	
	</script>
</head>
<body>
<div style="margin:auto;width:300px"> <h3>Glide Test</h3></div>
<div class="container" id="main">	

</div>

</body>
</html>
